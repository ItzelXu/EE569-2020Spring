% Name: Zheng Wen
% USC ID: 7112807212
% USC Email: zwen1423@usc.edu
% Submission Date 3/3/2020

% scanned from (i,j) = (1,1) to (3,3)
function cond_S = conditional_S(bond, double_pre_char)

[m,n] = size(bond);
cond_S = zeros(m,n);
for i=1:m
    for j=1:n
        switch bond(i,j)
            case 1 % 1
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('00100000') || ...
                      double_pre_char(i,j) == bin2dec('10000000') || ...
                      double_pre_char(i,j) == bin2dec('00000100') || ...
                      double_pre_char(i,j) == bin2dec('00000001');
            case 2 % 2
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('00001000') || ...
                      double_pre_char(i,j) == bin2dec('01000000') || ...
                      double_pre_char(i,j) == bin2dec('00010000') || ...
                      double_pre_char(i,j) == bin2dec('00000010');
            case 3 % 3
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('00101000') || ...
                      double_pre_char(i,j) == bin2dec('01100000') || ...
                      double_pre_char(i,j) == bin2dec('11000000') || ...
                      double_pre_char(i,j) == bin2dec('10010000') || ...
                      double_pre_char(i,j) == bin2dec('00010100') || ...
                      double_pre_char(i,j) == bin2dec('00000110') || ...
                      double_pre_char(i,j) == bin2dec('00000011') || ...
                      double_pre_char(i,j) == bin2dec('00001001');
            case 4 % 5
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('00101001') || ...
                      double_pre_char(i,j) == bin2dec('11100000') || ...
                      double_pre_char(i,j) == bin2dec('10010100') || ...
                      double_pre_char(i,j) == bin2dec('00000111');
            case 5 % 6
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('11001000') || ...
                      double_pre_char(i,j) == bin2dec('01001001') || ...
                      double_pre_char(i,j) == bin2dec('01110000') || ...
                      double_pre_char(i,j) == bin2dec('00101010') || ...
                      ... % 7
                      double_pre_char(i,j) == bin2dec('01101000') || ...
                      double_pre_char(i,j) == bin2dec('11010000') || ...
                      double_pre_char(i,j) == bin2dec('00010110') || ...
                      double_pre_char(i,j) == bin2dec('00001011');
            case 6 % 8
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('11001001') || ...
                      double_pre_char(i,j) == bin2dec('01110100') || ...
                      ... % 9
                      double_pre_char(i,j) == bin2dec('11101000') || ...
                      double_pre_char(i,j) == bin2dec('01101001') || ...
                      double_pre_char(i,j) == bin2dec('11110000') || ...
                      double_pre_char(i,j) == bin2dec('11010100') || ...
                      double_pre_char(i,j) == bin2dec('10010110') || ...
                      double_pre_char(i,j) == bin2dec('00010111') || ...
                      double_pre_char(i,j) == bin2dec('00001111') || ...
                      double_pre_char(i,j) == bin2dec('00101011');
            case 7 % 10
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('11101001') || ...
                      double_pre_char(i,j) == bin2dec('11110100') || ...
                      double_pre_char(i,j) == bin2dec('10010111') || ...
                      double_pre_char(i,j) == bin2dec('00101111');
            case 8 % 11
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('01101011') || ...
                      double_pre_char(i,j) == bin2dec('11111000') || ...
                      double_pre_char(i,j) == bin2dec('11010110') || ...
                      double_pre_char(i,j) == bin2dec('00011111');
            case 9 % 12
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('11101011') || ...
                      double_pre_char(i,j) == bin2dec('01101111') || ...
                      double_pre_char(i,j) == bin2dec('11111100') || ...
                      double_pre_char(i,j) == bin2dec('11111001') || ...
                      double_pre_char(i,j) == bin2dec('11110110') || ...
                      double_pre_char(i,j) == bin2dec('11010111') || ...
                      double_pre_char(i,j) == bin2dec('10011111') || ...
                      double_pre_char(i,j) == bin2dec('00111111');
            case 10 % 13
                cond_S(i,j) = double_pre_char(i,j) == bin2dec('11101111') || ...
                      double_pre_char(i,j) == bin2dec('11111101') || ...
                      double_pre_char(i,j) == bin2dec('11110111') || ...
                      double_pre_char(i,j) == bin2dec('10111111');
            otherwise
                cond_S(i,j) = 0;
        end
    end
end
end